<div class="col">
  <div class="card h-100 position-relative">
    <div class="position-relative">
      <!-- Tipo de comida -->
      <span class="badge bg-secondary position-absolute top-0 start-0 m-2">{{ mealType }}</span>

      <!-- Bot√≥n de Favoritos -->
      <button class="btn btn-light position-absolute top-0 end-0 m-2 rounded-circle shadow-sm"
              (click)="toggleFavorite(); $event.stopPropagation()">
        <i class="bi" [class.bi-heart-fill]="isFavorite" [class.bi-heart]="!isFavorite"
           [class.text-danger]="isFavorite" class="fs-5"></i>
      </button>

      <!-- Imagen -->
      <img [src]="imageUrl" class="card-img-top" [alt]="name">
    </div>

    <div class="card-body d-flex flex-column text-center" data-bs-toggle="modal" data-bs-target="#modalReceta">
      <!-- Nombre de la Receta con Tooltip -->
      <h6 class="card-title text-truncate"
          style="min-height: 1.5rem;"
          data-bs-toggle="tooltip"
          data-bs-placement="top"
          [attr.title]="name">
        {{ name }}
      </h6>

      <!-- Calorias -->
      <p class="mb-1 text-muted fw-bold">{{ calories }} kcal</p>

      <!-- Macronutrientes con Barras de Progreso -->
      <div class="text-start flex-grow-1">
        @for (macro of [
          { label: 'ü•© Prote√≠nas', value: proteins, color: 'bg-salmon' },
          { label: 'üçû Carbohidratos', value: carbs, color: 'bg-success' },
          { label: 'üßà Grasas', value: fats, color: 'bg-warning' }
        ]; track macro) {
          <div class="text-start">
            <small class="d-block text-truncate"
                   data-bs-toggle="tooltip"
                   data-bs-placement="top"
                   [attr.title]="macro.label + ': ' + macro.value + 'g'">
              {{ macro.label }}: {{ macro.value }}g
            </small>
            <div class="progress mb-2" style="height: 6px">
              <div class="progress-bar {{ macro.color }}" [style.width.%]="(macro.value / (proteins + carbs + fats)) * 100"></div>
            </div>
          </div>
        }
      </div>

      <!-- Tags Personalizados -->
      <div class="d-flex gap-1 mt-2 overflow-hidden text-nowrap">
        @for (tags of tags; track tags) {
          <span class="badge bg-primary text-white"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                [attr.title]="tags">
            {{ tags }}
          </span>
        }
      </div>

    </div>
  </div>
</div>
